/*---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
"use strict";
var package_json_reader_1 = require("../package-json-reader");
var lazy_disposable_1 = require("lazy-disposable");
/**
 * This is common practice for Node.js application to read information from
 * the package.json. The similar approach is used in the applicationinsights package.
 * path: node_modules/vs-telemetry/lib/internal/informationProviders
 */
var HostInformationProvider = (function () {
    function HostInformationProvider(packageJsonReader) {
        if (packageJsonReader === void 0) { packageJsonReader = new package_json_reader_1.PackageJsonReader(); }
        this._packageJson = lazy_disposable_1.lazy(function () { return packageJsonReader.read(); });
    }
    HostInformationProvider.prototype.overrideHostInformation = function (hostInformation) {
        if (hostInformation != null) {
            if (hostInformation.exeName != null) {
                this._overrideExeName = hostInformation.exeName;
            }
            if (hostInformation.exeVersion != null) {
                this._overrideExeVersion = hostInformation.exeVersion;
            }
        }
    };
    HostInformationProvider.prototype.applicationName = function () {
        if (this._overrideExeName != null) {
            return Promise.resolve(this._overrideExeName);
        }
        return this._packageJson().then(function (packageObj) { return (packageObj && packageObj.name) || ""; });
    };
    HostInformationProvider.prototype.applicationVersion = function () {
        if (this._overrideExeVersion != null) {
            return Promise.resolve(this._overrideExeVersion);
        }
        return this._packageJson().then(function (packageObj) { return (packageObj && packageObj.version) || ""; });
    };
    return HostInformationProvider;
}());
exports.HostInformationProvider = HostInformationProvider;
