/*---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
"use strict";
var PersistentSharedPropertyProvider = (function () {
    function PersistentSharedPropertyProvider(storageService, errorCollector) {
        this._storageService = storageService;
        this._errorCollector = errorCollector;
    }
    /**
     * Add shared properties to the provided context.
     * @param context Context to add shared property
     */
    PersistentSharedPropertyProvider.prototype.addSharedProperties = function (context) {
        var _this = this;
        return this._storageService.getAllItems().then(function (items) {
            for (var propName in items) {
                if (items.hasOwnProperty(propName)) {
                    context.setSharedProperty(propName, items[propName]);
                }
            }
        }).catch(function (err) { return _this._errorCollector.collectError("PersistentSharedPropertyProvider", "addSharedProperties", err.innerError); });
    };
    /**
     * Posts properties to the provided context.
     * @param context Context to post property
     */
    PersistentSharedPropertyProvider.prototype.postProperties = function (context) {
        return Promise.resolve(null);
    };
    return PersistentSharedPropertyProvider;
}());
exports.PersistentSharedPropertyProvider = PersistentSharedPropertyProvider;
